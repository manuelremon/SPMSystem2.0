import{b as P,r as j,j as e,F as M,T as k,C as b,e as N,i as y,P as C,D as S,d as E}from"./index-6Zj1ds2M.js";import{P as D}from"./PageHeader-Bbn3EATM.js";import{C as d,c,a as p,b as h}from"./Card-CP3YmPNB.js";import{f as u}from"./formatters-B3FH-qkk.js";import{L as T}from"./loader-2-kJ1bkqid.js";import{T as A}from"./trending-down-enbLk5EL.js";import{D as w}from"./dollar-sign-DF7jyOsr.js";import{X as z}from"./x-circle-DQFSXTGC.js";function g({data:i,maxValue:x}){return e.jsx("div",{className:"flex items-end gap-1 h-16",children:i.map((n,l)=>{const o=n/x*100;return e.jsx("div",{className:"flex-1 bg-[var(--primary)] rounded-t-sm transition-all duration-300 hover:bg-[var(--primary-bright)]",style:{height:`${o}%`},title:n},l)})})}function L({percentage:i,color:x="var(--primary)"}){const l=2*Math.PI*40,o=l-i/100*l;return e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsxs("svg",{className:"w-full h-full -rotate-90",children:[e.jsx("circle",{cx:"48",cy:"48",r:40,stroke:"var(--border)",strokeWidth:"8",fill:"none"}),e.jsx("circle",{cx:"48",cy:"48",r:40,stroke:x,strokeWidth:"8",fill:"none",strokeDasharray:l,strokeDashoffset:o,strokeLinecap:"round",className:"transition-all duration-500"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xl font-bold text-[var(--fg)]",children:[i,"%"]})})]})}function K({data:i}){const x=Math.max(...i),n=Math.min(...i),l=x-n||1,o=i.map((s,v)=>{const a=v/(i.length-1)*100,t=100-(s-n)/l*100;return`${a},${t}`}).join(" ");return e.jsx("div",{className:"h-12 w-full",children:e.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full",preserveAspectRatio:"none",children:[e.jsx("polyline",{points:o,fill:"none",stroke:"var(--primary)",strokeWidth:"2",vectorEffect:"non-scaling-stroke"}),e.jsx("polyline",{points:`0,100 ${o} 100,100`,fill:"var(--primary)",fillOpacity:"0.1"})]})})}function U(){const{t:i}=P(),[x,n]=j.useState(!0),[l,o]=j.useState(null),[s,v]=j.useState({solicitudes:{total:0,aprobadas:0,rechazadas:0,pendientes:0,trend:[0,0,0,0,0,0,0],trendPercentage:0},presupuesto:{total:0,utilizado:0,disponible:0,percentage:0,porCentro:[]},tiempoAprobacion:{promedio:0,meta:3,trend:[0,0,0,0,0,0,0]},materialesMasSolicitados:[],gruposArticulosMasSolicitados:[],solicitudesPorEstado:{labels:[],aprobadas:[],rechazadas:[],pendientes:[]}});return j.useEffect(()=>{(async()=>{var t,m;try{n(!0);const r=await E.get("/kpis");(t=r.data)!=null&&t.ok&&((m=r.data)!=null&&m.data)&&v(r.data.data)}catch(r){console.error("Error fetching KPIs:",r),o("Error al cargar los KPIs")}finally{n(!1)}})()},[]),x?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(T,{className:"w-8 h-8 animate-spin text-[var(--primary)]"})}):l?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("p",{className:"text-[var(--danger)]",children:l})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{title:"KPI's",breadcrumbs:[{label:"Dashboard",to:"/dashboard"},{label:"KPI's"}]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(d,{className:"border-l-4 border-l-[var(--primary)]",children:e.jsxs(c,{className:"pt-6 pb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider mb-1",children:"Total Solicitudes"}),e.jsx("p",{className:"text-3xl font-bold text-[var(--fg)]",children:s.solicitudes.total})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-[var(--primary-muted)]/20 grid place-items-center",children:e.jsx(M,{className:"w-6 h-6 text-[var(--primary)]"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-semibold",children:["+",s.solicitudes.trendPercentage,"%"]})]}),e.jsx("span",{className:"text-[var(--fg-muted)]",children:"vs mes anterior"})]})]})}),e.jsx(d,{className:"border-l-4 border-l-green-500",children:e.jsxs(c,{className:"pt-6 pb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider mb-1",children:"Tasa de Aprobación"}),e.jsxs("p",{className:"text-3xl font-bold text-[var(--fg)]",children:[Math.round(s.solicitudes.aprobadas/s.solicitudes.total*100),"%"]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-green-500/20 grid place-items-center",children:e.jsx(b,{className:"w-6 h-6 text-green-500"})})]}),e.jsxs("div",{className:"text-sm text-[var(--fg-muted)]",children:[s.solicitudes.aprobadas," aprobadas de ",s.solicitudes.total]})]})}),e.jsx(d,{className:"border-l-4 border-l-blue-500",children:e.jsxs(c,{className:"pt-6 pb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider mb-1",children:"Tiempo Promedio"}),e.jsxs("p",{className:"text-3xl font-bold text-[var(--fg)]",children:[s.tiempoAprobacion.promedio," días"]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-500/20 grid place-items-center",children:e.jsx(N,{className:"w-6 h-6 text-blue-500"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{className:"font-semibold",children:"Mejorando"})]}),e.jsxs("span",{className:"text-[var(--fg-muted)]",children:["Meta: ",s.tiempoAprobacion.meta," días"]})]})]})}),e.jsx(d,{className:"border-l-4 border-l-yellow-500",children:e.jsxs(c,{className:"pt-6 pb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider mb-1",children:"Presupuesto"}),e.jsx("p",{className:"text-2xl font-bold text-[var(--fg)]",children:u(s.presupuesto.utilizado)})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-yellow-500/20 grid place-items-center",children:e.jsx(w,{className:"w-6 h-6 text-yellow-500"})})]}),e.jsxs("div",{className:"text-sm text-[var(--fg-muted)]",children:[s.presupuesto.percentage,"% de ",u(s.presupuesto.total)]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsx(p,{className:"px-6 pt-6 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Tendencia de Solicitudes"}),e.jsx(y,{className:"w-5 h-5 text-[var(--primary)]"})]})}),e.jsxs(c,{className:"px-6 pb-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(K,{data:s.solicitudes.trend})}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-xs text-[var(--fg-muted)] text-center",children:["Lun","Mar","Mié","Jue","Vie","Sáb","Dom"].map(a=>e.jsx("div",{children:a},a))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-[var(--border)] flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-[var(--fg-muted)]",children:"Promedio semanal"}),e.jsxs("span",{className:"font-semibold text-[var(--fg)]",children:[Math.round(s.solicitudes.trend.reduce((a,t)=>a+t,0)/s.solicitudes.trend.length)," solicitudes"]})]})]})]}),e.jsxs(d,{children:[e.jsx(p,{className:"px-6 pt-6 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Presupuesto por Centro"}),e.jsx(w,{className:"w-5 h-5 text-[var(--primary)]"})]})}),e.jsx(c,{className:"px-6 pb-6",children:e.jsx("div",{className:"space-y-4",children:s.presupuesto.porCentro.map((a,t)=>{const m=Math.max(...s.presupuesto.porCentro.map(f=>f.valor)),r=a.valor/m*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 text-sm",children:[e.jsx("span",{className:"text-[var(--fg-muted)] font-medium",children:a.nombre}),e.jsx("span",{className:"text-[var(--fg)] font-semibold",children:u(a.valor)})]}),e.jsx("div",{className:"h-2 bg-[var(--bg-soft)] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-[var(--primary)] rounded-full transition-all duration-500",style:{width:`${r}%`}})})]},t)})})})]}),e.jsxs(d,{children:[e.jsx(p,{className:"px-6 pt-6 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Materiales Más Solicitados"}),e.jsx(C,{className:"w-5 h-5 text-[var(--primary)]"})]})}),e.jsx(c,{className:"px-6 pb-6",children:e.jsx("div",{className:"space-y-3",children:(s.materialesMasSolicitados||[]).length>0?s.materialesMasSolicitados.map((a,t)=>{const m=Math.max(...s.materialesMasSolicitados.map(f=>f.cantidad),1),r=a.cantidad/m*100;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[var(--primary-muted)]/20 grid place-items-center text-sm font-bold text-[var(--primary)]",children:t+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5 text-sm",children:[e.jsx("span",{className:"text-[var(--fg)] font-medium",children:a.nombre}),e.jsx("span",{className:"text-[var(--fg-muted)]",children:(a.cantidad||0).toLocaleString()})]}),e.jsx("div",{className:"h-1.5 bg-[var(--bg-soft)] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[var(--primary)] to-[var(--primary-bright)] rounded-full transition-all duration-500",style:{width:`${r}%`}})})]})]},t)}):e.jsx("p",{className:"text-sm text-[var(--fg-muted)] text-center py-4",children:"No hay datos de materiales disponibles"})})})]}),e.jsxs(d,{children:[e.jsx(p,{className:"px-6 pt-6 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Distribución de Estados"}),e.jsx(y,{className:"w-5 h-5 text-[var(--primary)]"})]})}),e.jsxs(c,{className:"px-6 pb-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-[var(--fg)]",children:"Aprobadas"})]}),e.jsx("span",{className:"text-sm font-semibold text-[var(--fg)]",children:s.solicitudes.aprobadas})]}),e.jsx(g,{data:s.solicitudesPorEstado.aprobadas||[],maxValue:Math.max(...s.solicitudesPorEstado.aprobadas||[1],1)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-[var(--fg)]",children:"Rechazadas"})]}),e.jsx("span",{className:"text-sm font-semibold text-[var(--fg)]",children:s.solicitudes.rechazadas})]}),e.jsx(g,{data:s.solicitudesPorEstado.rechazadas||[],maxValue:Math.max(...s.solicitudesPorEstado.aprobadas||[1],1)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-sm font-medium text-[var(--fg)]",children:"Pendientes"})]}),e.jsx("span",{className:"text-sm font-semibold text-[var(--fg)]",children:s.solicitudes.pendientes})]}),e.jsx(g,{data:s.solicitudesPorEstado.pendientes||[],maxValue:Math.max(...s.solicitudesPorEstado.aprobadas||[1],1)})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-[var(--border)] grid grid-cols-6 gap-1 text-xs text-[var(--fg-muted)] text-center",children:(s.solicitudesPorEstado.labels||[]).map((a,t)=>e.jsx("div",{children:a},t))})]})]}),e.jsxs(d,{children:[e.jsx(p,{className:"px-6 pt-6 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Grupos de Artículos Más Solicitados"}),e.jsx(S,{className:"w-5 h-5 text-[var(--accent)]"})]})}),e.jsx(c,{className:"px-6 pb-6",children:e.jsx("div",{className:"space-y-3",children:(s.gruposArticulosMasSolicitados||[]).length>0?s.gruposArticulosMasSolicitados.map((a,t)=>{const m=Math.max(...s.gruposArticulosMasSolicitados.map(f=>f.cantidad)),r=a.cantidad/m*100;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[var(--accent)]/20 grid place-items-center text-sm font-bold text-[var(--accent)]",children:t+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5 text-sm",children:[e.jsx("span",{className:"text-[var(--fg)] font-medium",children:a.nombre}),e.jsx("span",{className:"text-[var(--fg-muted)]",children:a.cantidad.toLocaleString()})]}),e.jsx("div",{className:"h-1.5 bg-[var(--bg-soft)] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[var(--accent)] to-cyan-400 rounded-full transition-all duration-500",style:{width:`${r}%`}})})]})]},t)}):e.jsx("p",{className:"text-sm text-[var(--fg-muted)] text-center py-4",children:"No hay datos de grupos disponibles"})})})]})]}),e.jsxs(d,{children:[e.jsx(p,{className:"px-6 pt-6 pb-4",children:e.jsx(h,{children:"Resumen de Presupuesto"})}),e.jsx(c,{className:"px-6 pb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(L,{percentage:s.presupuesto.percentage})}),e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-6 w-full",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider mb-2",children:"Presupuesto Total"}),e.jsx("p",{className:"text-2xl font-bold text-[var(--fg)]",children:u(s.presupuesto.total)})]}),e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider mb-2",children:"Utilizado"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:u(s.presupuesto.utilizado)})]}),e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider mb-2",children:"Disponible"}),e.jsx("p",{className:"text-2xl font-bold text-green-500",children:u(s.presupuesto.disponible)})]})]})]})})]})]})}export{U as default};
