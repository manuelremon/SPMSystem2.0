import{r as t,j as r,U as g,Q as y,w as h,O as x}from"./index-R2nLXBvN.js";import{A}from"./AdminCrudTemplate-Ctaa2l_-.js";import{B as p}from"./Badge-Dc2qBnq-.js";import{a as _}from"./spm-KhWb3Sq8.js";import"./Card-D1AN4Z4i.js";import"./Input-BSisSO4-.js";import"./Select-BLDKx88b.js";import"./SearchInput-BQdutgqd.js";import"./DataTable-C3Ky6Udx.js";import"./inbox-By3XAFzB.js";import"./chevron-up-IMWjEcLD.js";import"./Alert-CPviSfZe.js";import"./alert-circle-DpQSvc7T.js";import"./x-circle-CBdIdiEC.js";import"./check-circle-DujjALsM.js";import"./PageHeader-D8Wfw19Y.js";import"./ConfirmModal-BqnSI68D.js";import"./Skeleton-C8Y3cP6w.js";import"./useDebounced-PrrVbFr3.js";import"./pen-line-D8b4y6OR.js";import"./trash-2-aZIQB1FM.js";import"./plus-ByPn5K8U.js";function F(){const[u,m]=t.useState([]),[b,v]=t.useState(!0);t.useEffect(()=>{(async()=>{try{const a=await _.list("usuarios"),o=Array.isArray(a.data)?a.data:[];m(o)}catch(a){console.error("Error cargando usuarios:",a)}finally{v(!1)}})()},[]);const i=u.map(e=>({value:e.id_spm,label:`${e.nombre} ${e.apellido} (${e.id_spm})`.trim(),posicion:e.posicion})),s=i.filter(e=>{var a;return((a=e.posicion)==null?void 0:a.toLowerCase())==="jefe"}),n=i.filter(e=>{var a;return((a=e.posicion)==null?void 0:a.toLowerCase())==="gerente nivel 1"}),c=i.filter(e=>{var a;return((a=e.posicion)==null?void 0:a.toLowerCase())==="gerente nivel 2"});return b?r.jsx("div",{className:"p-6",children:"Cargando..."}):r.jsx(A,{title:"Usuarios",resource:"usuarios",idKey:"id_spm",columns:[{key:"id_spm",label:"ID SPM"},{key:"nombre",label:"Nombre Completo",render:e=>`${e.nombre} ${e.apellido}`.trim()||"-"},{key:"roles",label:"Roles",render:e=>{const a={administrador:{bg:"var(--danger)",text:"var(--on-danger)"},admin:{bg:"var(--danger)",text:"var(--on-danger)"},planificador:{bg:"var(--primary)",text:"var(--on-primary)"},solicitante:{bg:"var(--success)",text:"var(--on-success)"},aprobador_solicitudes:{bg:"var(--warning)",text:"var(--on-warning)"},aprobador_presupuestos:{bg:"var(--info)",text:"var(--on-info)"}};let o=e.roles||e.rol||[];if(typeof o=="string")try{o=JSON.parse(o)}catch{o=[o]}return Array.isArray(o)||(o=[o]),r.jsx("div",{className:"flex flex-wrap gap-1",children:o.length>0?o.map((l,f)=>{const d=a[l==null?void 0:l.toLowerCase()]||{bg:"var(--fg-muted)",text:"var(--bg)"};return r.jsx(p,{style:{backgroundColor:d.bg,color:d.text},className:"uppercase text-xs font-semibold",children:l},f)}):r.jsx("span",{className:"text-xs text-[var(--fg-muted)]",children:"Sin roles"})})}},{key:"mail",label:"Email"},{key:"posicion",label:"Puesto"},{key:"sector",label:"Sector"},{key:"id_ypf",label:"ID YPF"},{key:"estado_registro",label:"Estado",render:e=>{var o;const a=((o=e.estado_registro)==null?void 0:o.toLowerCase())==="activo";return r.jsx(p,{variant:a?"success":"neutral",className:"uppercase text-xs",children:e.estado_registro||"Inactivo"})}}],fields:[{name:"section_personal",type:"section",label:"Información Personal",description:"Datos básicos de identificación del usuario",icon:g},{name:"id_spm",label:"ID SPM",required:!0,placeholder:"Ej: usuario123"},{name:"nombre",label:"Nombre",required:!0,placeholder:"Ej: Juan"},{name:"apellido",label:"Apellido",required:!0,placeholder:"Ej: Pérez"},{name:"mail",label:"Email Principal",required:!0,type:"email",placeholder:"usuario@empresa.com"},{name:"mail_respaldo",label:"Email de Respaldo",type:"email",placeholder:"Email secundario de contacto"},{name:"telefono",label:"Teléfono",type:"tel",placeholder:"+54 9 11 1234-5678"},{name:"section_laboral",type:"section",label:"Información Laboral",description:"Posición, sector y permisos del usuario",icon:y},{name:"posicion",label:"Puesto",required:!0,type:"select",options:[{value:"Empleado",label:"Empleado"},{value:"Jefe",label:"Jefe"},{value:"Gerente Nivel 1",label:"Gerente Nivel 1"},{value:"Gerente Nivel 2",label:"Gerente Nivel 2"},{value:"Director",label:"Director"}],defaultValue:"Empleado",placeholder:"Selecciona el puesto"},{name:"id_ypf",label:"ID YPF",placeholder:"Identificador YPF del usuario"},{name:"sector",label:"Sector",type:"select",options:[{value:"1",label:"Almacenes"},{value:"2",label:"Compras"},{value:"3",label:"Mantenimiento"},{value:"4",label:"Planificación"},{value:"5",label:"Operaciones"},{value:"6",label:"Logística"},{value:"7",label:"Producción"},{value:"8",label:"Calidad"}],placeholder:"Selecciona un sector"},{name:"roles",label:"Roles del Sistema",required:!0,type:"checkbox-group",options:[{value:"solicitante",label:"Solicitante",description:"Puede crear y gestionar solicitudes de materiales"},{value:"aprobador_solicitudes",label:"Aprobador de Solicitudes",description:"Puede aprobar o rechazar solicitudes de materiales"},{value:"aprobador_presupuestos",label:"Aprobador de Presupuestos",description:"Puede aprobar incorporaciones de presupuesto"},{value:"planificador",label:"Planificador",description:"Puede planificar y gestionar el despacho de solicitudes"},{value:"administrador",label:"Administrador",description:"Acceso completo al sistema"}],placeholder:"Un usuario puede tener múltiples roles según sus responsabilidades",defaultValue:["solicitante"],fullWidth:!0},{name:"section_asignaciones",type:"section",label:"Asignaciones",description:"Centros, almacenes y jerarquía organizacional",icon:h},{name:"centros",label:"Centros Autorizados",placeholder:"Ej: 1008,1064,1100 (separados por comas)",fullWidth:!0},{name:"almacenes",label:"Almacenes Autorizados",placeholder:"Ej: ALM001,ALM002 (separados por comas)",fullWidth:!0},{name:"jefe",label:"Jefe Directo",type:"select",options:s,placeholder:s.length>0?"Selecciona el jefe directo":"No hay usuarios con puesto Jefe"},{name:"gerente1",label:"Gerente Nivel 1",type:"select",options:n,placeholder:n.length>0?"Selecciona el gerente nivel 1":"No hay usuarios con puesto Gerente Nivel 1"},{name:"gerente2",label:"Gerente Nivel 2",type:"select",options:c,placeholder:c.length>0?"Selecciona el gerente nivel 2":"No hay usuarios con puesto Gerente Nivel 2"},{name:"section_cuenta",type:"section",label:"Configuración de Cuenta",description:"Estado y credenciales de acceso",icon:x},{name:"estado_registro",label:"Estado de la Cuenta",required:!0,type:"select",options:[{value:"Activo",label:"Activo"},{value:"Inactivo",label:"Inactivo"},{value:"Suspendido",label:"Suspendido"}],defaultValue:"Activo"},{name:"contrasena",label:"Contraseña",required:!0,type:"password",defaultValue:"Temporal2024!",placeholder:"Contraseña temporal (el usuario debe cambiarla)"}]})}export{F as default};
