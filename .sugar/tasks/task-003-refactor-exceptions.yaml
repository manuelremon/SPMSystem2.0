# Sugar Task
id: task-003
title: "Refactorizar excepciones genéricas en agent/routes.py"
priority: 3
type: refactoring
status: completed
created: 2025-11-28
source: codebase_analysis

description: |
  El archivo backend_v2/agent/routes.py contiene 20 bloques
  'except Exception' que capturan errores de forma genérica.
  Esto dificulta el debugging y puede ocultar problemas reales.

context:
  file: "backend_v2/agent/routes.py"
  occurrences: 20
  lines: [70, 90, 116, 135, 176, 196, 215, 235, 256, 276, 296, 316, 336, 356, 376, 407, 425, 451]

technical_requirements:
  - Identificar tipos de excepciones específicas posibles
  - Reemplazar 'except Exception' por excepciones específicas
  - Agregar logging apropiado para cada tipo
  - Mantener fallback genérico solo cuando sea necesario
  - Mejorar mensajes de error para el usuario

success_criteria:
  - Reducir 'except Exception' en 50%+
  - Logging mejorado para debugging
  - Sin cambios en comportamiento externo
  - Tests existentes pasan

estimated_complexity: medium
