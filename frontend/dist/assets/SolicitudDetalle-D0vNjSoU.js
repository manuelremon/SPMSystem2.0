import{o as V,u as $,b as F,r as h,j as e,B as n,U as H,e as M,v as U,w as I,M as R,P as D,F as G}from"./index-C0KzVn15.js";import{s as J}from"./spm-DzdMHgGJ.js";import{C as u,a as f,b as j,c as g}from"./Card-CZhI6Cu1.js";import{B as q}from"./Badge-d4rYTU1N.js";import{A as P}from"./Alert-JliWwR_S.js";import{P as p}from"./PageHeader-CTTYnUT3.js";import{S as v}from"./ScrollReveal-CaWzGJkt.js";import{S as z}from"./StatusBadge-D5wkbHRd.js";import{b as B,g as K,a as O,f as b}from"./formatters-B3FH-qkk.js";import{A as N}from"./arrow-left-dAZJ5Etu.js";import{H as Q}from"./hash-DBcYpjxA.js";import{C as W}from"./calendar-BlvF1TmX.js";import{D as L}from"./dollar-sign-B0Ok6wWx.js";import"./info-A2zy8862.js";import"./alert-circle-mNlb3XAQ.js";import"./x-circle-BDEZXh-7.js";import"./check-circle-BLjEl7wu.js";import"./styleConfig-C9OnW5Az.js";import"./archive-C56S_fxM.js";function i({icon:c,label:l,value:a,className:t=""}){return e.jsxs("div",{className:`flex items-start gap-3 ${t}`,children:[e.jsx("div",{className:"h-9 w-9 rounded-lg bg-[var(--bg-elevated)] border border-[var(--border)] grid place-items-center flex-shrink-0",children:e.jsx(c,{className:"w-4 h-4 text-[var(--fg-muted)]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider",children:l}),e.jsx("p",{className:"text-sm text-[var(--fg)] mt-0.5 break-words",children:a||"-"})]})]})}function X(){return e.jsxs("div",{className:"space-y-6 animate-pulse",children:[e.jsx("div",{className:"h-8 bg-[var(--bg-soft)] rounded w-1/3"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-48 bg-[var(--bg-soft)] rounded-xl"}),e.jsx("div",{className:"h-48 bg-[var(--bg-soft)] rounded-xl"})]}),e.jsx("div",{className:"h-64 bg-[var(--bg-soft)] rounded-xl"})]})}function ge(){const{id:c}=V(),l=$(),{t:a}=F(),[t,w]=h.useState(null),[T,C]=h.useState(!0),[S,_]=h.useState("");if(h.useEffect(()=>{c&&(async()=>{var m,d,o,x;C(!0),_("");try{const r=await J.obtener(c);(m=r.data)!=null&&m.solicitud?w(r.data.solicitud):r.data?w(r.data):_("No se encontró la solicitud")}catch(r){console.error("Error fetching solicitud:",r),_(((x=(o=(d=r.response)==null?void 0:d.data)==null?void 0:o.error)==null?void 0:x.message)||r.message||"Error al cargar la solicitud")}finally{C(!1)}})()},[c]),T)return e.jsxs("div",{className:"space-y-6",children:[e.jsx(p,{title:a("detalle_loading","Cargando solicitud..."),actions:e.jsxs(n,{variant:"ghost",onClick:()=>l(-1),children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),a("common_back","Volver")]})}),e.jsx(X,{})]});if(S)return e.jsxs("div",{className:"space-y-6",children:[e.jsx(p,{title:a("detalle_error_title","Error"),actions:e.jsxs(n,{variant:"ghost",onClick:()=>l(-1),children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),a("common_back","Volver")]})}),e.jsx(P,{variant:"danger",children:S})]});if(!t)return e.jsxs("div",{className:"space-y-6",children:[e.jsx(p,{title:a("detalle_not_found","Solicitud no encontrada"),actions:e.jsxs(n,{variant:"ghost",onClick:()=>l(-1),children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),a("common_back","Volver")]})}),e.jsx(P,{variant:"warning",children:a("detalle_not_found_msg","La solicitud solicitada no existe o fue eliminada.")})]});const y=t.items||[],k=t.estado||t.status||"pendiente",A=t.criticidad||"Normal",E=A.toLowerCase().includes("alta");return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{children:e.jsx(p,{title:`${a("detalle_title","Solicitud")} #${t.id}`,actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{estado:k}),e.jsxs(n,{variant:"ghost",onClick:()=>l(-1),children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),a("common_back","Volver")]})]})})}),e.jsx(v,{delay:100,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(u,{children:[e.jsx(f,{children:e.jsx(j,{children:a("detalle_info_general","Información General")})}),e.jsxs(g,{className:"space-y-4",children:[e.jsx(i,{icon:Q,label:a("detalle_id","ID de Solicitud"),value:t.id}),e.jsx(i,{icon:H,label:a("detalle_solicitante","Solicitante"),value:t.id_usuario||t.solicitante}),e.jsx(i,{icon:W,label:a("detalle_fecha_creacion","Fecha de Creación"),value:B(t.created_at||t.fecha_creacion)}),e.jsx(i,{icon:M,label:a("detalle_fecha_necesidad","Fecha de Necesidad"),value:B(t.fecha_necesidad)}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg bg-[var(--bg-elevated)] border border-[var(--border)] grid place-items-center flex-shrink-0",children:e.jsx(U,{className:`w-4 h-4 ${E?"text-[var(--danger)]":"text-[var(--fg-muted)]"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider",children:a("detalle_criticidad","Criticidad")}),e.jsx(q,{variant:E?"danger":"default",className:"mt-1 uppercase text-xs font-semibold",children:A})]})]})]})]}),e.jsxs(u,{children:[e.jsx(f,{children:e.jsx(j,{children:a("detalle_ubicacion","Ubicación y Costos")})}),e.jsxs(g,{className:"space-y-4",children:[e.jsx(i,{icon:I,label:a("detalle_centro","Centro"),value:t.centro||t.centro_id}),e.jsx(i,{icon:R,label:a("detalle_sector","Sector"),value:K(t.sector||t.sector_id)}),e.jsx(i,{icon:D,label:a("detalle_almacen","Almacén Virtual"),value:O(t.almacen_virtual||t.almacen)}),e.jsx(i,{icon:L,label:a("detalle_centro_costos","Centro de Costos"),value:t.centro_costos}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg bg-[var(--primary-muted)]/20 border border-[var(--primary)]/30 grid place-items-center flex-shrink-0",children:e.jsx(L,{className:"w-4 h-4 text-[var(--primary)]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-[var(--fg-muted)] uppercase tracking-wider",children:a("detalle_monto_total","Monto Total")}),e.jsx("p",{className:"text-lg font-bold text-[var(--primary)] mt-0.5",children:b(t.total_monto||0)})]})]})]})]})]})}),e.jsx(v,{delay:200,children:e.jsxs(u,{children:[e.jsx(f,{children:e.jsx(j,{children:a("detalle_justificacion","Justificación")})}),e.jsx(g,{children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg bg-[var(--bg-elevated)] border border-[var(--border)] grid place-items-center flex-shrink-0",children:e.jsx(G,{className:"w-4 h-4 text-[var(--fg-muted)]"})}),e.jsx("p",{className:"text-sm text-[var(--fg)] leading-relaxed flex-1",children:t.justificacion||a("detalle_sin_justificacion","Sin justificación proporcionada")})]})})]})}),e.jsx(v,{delay:300,children:e.jsxs(u,{children:[e.jsx(f,{className:"flex flex-row items-center justify-between",children:e.jsxs(j,{children:[a("detalle_materiales","Materiales")," (",y.length,")"]})}),e.jsx(g,{children:y.length===0?e.jsxs("div",{className:"text-center py-8 text-[var(--fg-muted)]",children:[e.jsx(D,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:a("detalle_sin_items","No hay materiales en esta solicitud")})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-[var(--border)]",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-[var(--fg-muted)]",children:a("detalle_item_codigo","Código")}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-[var(--fg-muted)]",children:a("detalle_item_descripcion","Descripción")}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-[var(--fg-muted)]",children:a("detalle_item_cantidad","Cantidad")}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-[var(--fg-muted)]",children:a("detalle_item_precio","Precio Unit.")}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-[var(--fg-muted)]",children:a("detalle_item_subtotal","Subtotal")})]})}),e.jsx("tbody",{children:y.map((s,m)=>{const d=Number(s.precio_unitario||s.precio||0),o=Number(s.cantidad||0),x=d*o;return e.jsxs("tr",{className:"border-b border-[var(--border)] last:border-b-0 hover:bg-[var(--bg-elevated)] transition-colors",children:[e.jsx("td",{className:"py-3 px-4 font-mono text-[var(--fg)]",children:s.codigo||s.material_codigo||"-"}),e.jsx("td",{className:"py-3 px-4 text-[var(--fg)]",children:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("p",{className:"truncate",title:s.descripcion||s.material_descripcion,children:s.descripcion||s.material_descripcion||"-"}),s.comentario&&e.jsx("p",{className:"text-xs text-[var(--fg-muted)] mt-1 truncate",title:s.comentario,children:s.comentario})]})}),e.jsxs("td",{className:"py-3 px-4 text-right font-medium text-[var(--fg)]",children:[o," ",s.unidad||""]}),e.jsx("td",{className:"py-3 px-4 text-right font-mono text-[var(--fg-muted)]",children:b(d)}),e.jsx("td",{className:"py-3 px-4 text-right font-mono font-medium text-[var(--fg)]",children:b(x)})]},m)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-[var(--bg-elevated)]",children:[e.jsxs("td",{colSpan:4,className:"py-3 px-4 text-right font-semibold text-[var(--fg)]",children:[a("detalle_total","Total"),":"]}),e.jsx("td",{className:"py-3 px-4 text-right font-mono font-bold text-lg text-[var(--primary)]",children:b(t.total_monto||0)})]})})]})})})]})}),k.toLowerCase()==="borrador"&&e.jsx("div",{className:"flex justify-end gap-3",children:e.jsx(n,{variant:"secondary",onClick:()=>l(`/solicitudes/${t.id}/materiales`),children:a("detalle_btn_editar","Editar Solicitud")})})]})}export{ge as default};
