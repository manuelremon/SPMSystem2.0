import{c as D,u as R,a as q,b as H,r as l,D as E,j as e,B as g,q as p,g as b,e as _,F,U as L}from"./index-R2nLXBvN.js";import{C as B,a as P,b as S,c as U}from"./Card-D1AN4Z4i.js";import{P as O}from"./PageHeader-D8Wfw19Y.js";import{A as v,I as X}from"./Alert-CPviSfZe.js";import{C as z}from"./check-BjEL0cX9.js";import{T as G}from"./trash-2-aZIQB1FM.js";import{X as j}from"./x-circle-CBdIdiEC.js";import{C as N}from"./check-circle-DujjALsM.js";import{A as J}from"./alert-circle-DpQSvc7T.js";const K=D("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]),C={info:{icon:X,color:"text-blue-400",bg:"bg-blue-500/10"},success:{icon:N,color:"text-green-400",bg:"bg-green-500/10"},warning:{icon:J,color:"text-yellow-400",bg:"bg-yellow-500/10"},error:{icon:j,color:"text-red-400",bg:"bg-red-500/10"},profile_request:{icon:L,color:"text-purple-400",bg:"bg-purple-500/10"},solicitud_created:{icon:F,color:"text-cyan-400",bg:"bg-cyan-500/10"},solicitud_approved:{icon:N,color:"text-green-400",bg:"bg-green-500/10"},solicitud_rejected:{icon:j,color:"text-red-400",bg:"bg-red-500/10"},solicitud_planned:{icon:_,color:"text-orange-400",bg:"bg-orange-500/10"}};function Q(r){if(!r)return"";const d=new Date(r),c=new Date-d,t=Math.floor(c/6e4),o=Math.floor(c/36e5),n=Math.floor(c/864e5);return t<1?"Ahora":t<60?`Hace ${t} min`:o<24?`Hace ${o}h`:n<7?`Hace ${n}d`:d.toLocaleDateString("es-AR",{day:"2-digit",month:"short"})}function re(){const r=R(),{user:d}=q(),{t:a}=H(),[c,t]=l.useState(""),{notifications:o,unreadCount:n,isLoading:x,error:f,markAsRead:m,markAllAsRead:u,deleteNotification:h,refresh:k}=E({enabled:!!d}),y=l.useCallback(async s=>{await m(s)&&(t(a("notif_marcada_leida","Notificacion marcada como leida")),setTimeout(()=>t(""),2e3))},[m,a]),w=l.useCallback(async()=>{await u()&&(t(a("notif_todas_leidas","Todas las notificaciones marcadas como leidas")),setTimeout(()=>t(""),2e3))},[u,a]),A=l.useCallback(async s=>{if(!confirm(a("notif_confirmar_eliminar","¿Eliminar esta notificacion?")))return;await h(s)&&(t(a("notif_eliminada","Notificacion eliminada")),setTimeout(()=>t(""),2e3))},[h,a]),M=l.useCallback(s=>{var i;s.leido||m(s.id),s.solicitud_id&&(s.tipo==="profile_request"||(i=s.mensaje)!=null&&i.includes("cambio de perfil")?r("/admin/solicitudes-perfil"):r(`/solicitudes/${s.solicitud_id}`))},[m,r]),T=s=>C[s]||C.info;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(O,{title:a("notif_title","NOTIFICACIONES").toUpperCase(),actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{variant:"ghost",onClick:k,disabled:x,children:[e.jsx(p,{className:`w-4 h-4 mr-2 ${x?"animate-spin":""}`}),a("common_refresh","Actualizar")]}),n>0&&e.jsxs(g,{onClick:w,children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),a("notif_marcar_todas","Marcar todas como leidas")]})]})}),f&&e.jsx(v,{variant:"danger",children:f}),c&&e.jsx(v,{variant:"success",onDismiss:()=>t(""),children:c}),e.jsxs(B,{children:[e.jsx(P,{children:e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-[var(--primary)]"}),a("notif_subtitle","Centro de Notificaciones"),n>0&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 rounded-full bg-[var(--primary)] text-[var(--on-primary)] text-xs font-bold",children:[n," ",a("notif_sin_leer","sin leer")]})]})}),e.jsx(U,{children:x&&o.length===0?e.jsxs("div",{className:"text-center py-12 text-[var(--fg-muted)]",children:[e.jsx(p,{className:"w-8 h-8 mx-auto mb-3 animate-spin"}),e.jsx("p",{children:a("common_cargando","Cargando...")})]}):o.length===0?e.jsxs("div",{className:"text-center py-12 text-[var(--fg-muted)]",children:[e.jsx(b,{className:"w-12 h-12 mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"text-lg font-medium",children:a("notif_empty","No tienes notificaciones")}),e.jsx("p",{className:"text-sm mt-1",children:a("notif_empty_desc","Cuando recibas alertas del sistema, apareceran aqui")})]}):e.jsx("div",{className:"divide-y divide-[var(--border)]",children:o.map(s=>{const i=T(s.tipo),$=i.icon;return e.jsxs("div",{className:`flex items-start gap-4 p-4 transition-colors cursor-pointer hover:bg-[var(--surface)] ${s.leido?"":"bg-[var(--primary)]/5"}`,onClick:()=>M(s),children:[e.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full ${i.bg} flex items-center justify-center`,children:e.jsx($,{className:`w-5 h-5 ${i.color}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm ${s.leido?"text-[var(--fg-muted)]":"font-semibold text-[var(--fg)]"}`,children:s.mensaje}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(_,{className:"w-3 h-3 text-[var(--fg-subtle)]"}),e.jsx("span",{className:"text-xs text-[var(--fg-subtle)]",children:Q(s.created_at)}),s.solicitud_id&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[var(--fg-subtle)]",children:"•"}),e.jsxs("span",{className:"text-xs text-[var(--primary)]",children:["#",s.solicitud_id]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1",onClick:I=>I.stopPropagation(),children:[!s.leido&&e.jsx("button",{onClick:()=>y(s.id),className:"p-2 rounded-lg hover:bg-[var(--bg-elevated)] text-[var(--fg-muted)] hover:text-[var(--success)] transition-colors",title:a("notif_marcar_leida","Marcar como leida"),children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(s.id),className:"p-2 rounded-lg hover:bg-[var(--bg-elevated)] text-[var(--fg-muted)] hover:text-[var(--danger)] transition-colors",title:a("notif_eliminar","Eliminar"),children:e.jsx(G,{className:"w-4 h-4"})})]}),!s.leido&&e.jsx("div",{className:"flex-shrink-0 w-2 h-2 rounded-full bg-[var(--primary)] mt-2"})]},s.id)})})})]})]})}export{re as default};
