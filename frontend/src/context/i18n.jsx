import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

const I18nContext = createContext({
  lang: "es",
  t: (key, fallback) => fallback || key,
  setLang: () => {},
});

const translations = {
  // Layout / nav
  nav_solicitudes: { es: "Solicitudes", en: "Requests" },
  nav_aprobaciones: { es: "Aprobaciones", en: "Approvals" },
  nav_planificador: { es: "Planificador", en: "Planner" },
  nav_admin: { es: "Administración", en: "Admin" },
  nav_nueva: { es: "Nueva Solicitud", en: "New Request" },
  nav_mis: { es: "Mis Solicitudes", en: "My Requests" },
  nav_todas: { es: "Todas las Solicitudes", en: "All Requests" },
  nav_panel_tratamiento: { es: "Panel de Tratamiento", en: "Treatment Panel" },
  nav_asignadas: { es: "Solicitudes asignadas a mí", en: "Requests assigned to me" },
  nav_no_asignadas: { es: "Solicitudes no asignadas a mí", en: "Requests not assigned to me" },
  nav_mi_cuenta: { es: "Mi cuenta", en: "My account" },
  nav_cerrar: { es: "Cerrar sesión", en: "Sign out" },
  nav_kpi: { es: "KPI's", en: "KPI's" },
  nav_presupuesto: { es: "Presupuesto", en: "Budget" },
  nav_historial_aprobaciones: { es: "Historial de Aprobaciones", en: "Approvals History" },
  admin_centros: { es: "Centros", en: "Plants" },
  admin_almacenes: { es: "Almacenes", en: "Warehouses" },
  admin_sectores: { es: "Sectores", en: "Sectors" },
  admin_usuarios: { es: "Usuarios", en: "Users" },
  admin_planificadores: { es: "Planificadores", en: "Planners" },
  admin_presupuestos: { es: "Presupuestos", en: "Budgets" },
  admin_puestos: { es: "Puestos", en: "Positions" },
  admin_roles: { es: "Roles", en: "Roles" },
  admin_materiales: { es: "Materiales", en: "Materials" },
  admin_estado: { es: "Estado del Sistema", en: "System Status" },
  admin_metricas: { es: "Métricas", en: "Metrics" },
  admin_cat_registros: { es: "Registros", en: "Records" },
  admin_cat_locaciones: { es: "Locaciones", en: "Locations" },
  admin_cat_sistema: { es: "Sistema", en: "System" },
  tooltip_mensajes: { es: "Mensajes", en: "Messages" },
  tooltip_notif: { es: "Notificaciones", en: "Notifications" },
  tooltip_tema: { es: "Cambiar tema", en: "Toggle theme" },
  tooltip_lang: { es: "Cambiar idioma", en: "Change language" },
  tooltip_abrir_menu: { es: "Abrir menú", en: "Open menu" },
  tooltip_cerrar_menu: { es: "Cerrar menú", en: "Close menu" },

  // Dashboard
  dash_totales: { es: "Solicitudes totales", en: "Total requests" },
  dash_en_aprob: { es: "En aprobacion", en: "In approval" },
  dash_en_plan: { es: "En planificacion", en: "In planning" },
  dash_presupuesto: { es: "Presupuesto", en: "Budget" },
  dash_saldo: { es: "Saldo disponible (USD)", en: "Available balance (USD)" },
  dash_recientes: { es: "Solicitudes recientes", en: "Recent requests" },
  dash_recientes_desc: { es: "Ultimas 8 solicitudes creadas o tratadas.", en: "Last 8 created or processed requests." },
  dash_notif_title: { es: "Notificaciones", en: "Notifications" },
  dash_notif_desc: { es: "Alertas y pendientes", en: "Alerts and pending" },
  dash_notif_none: { es: "Sin notificaciones criticas.", en: "No critical notifications." },
  dash_novedades: { es: "Novedades SPM", en: "SPM updates" },
  dash_novedades_desc: { es: "Lo ultimo", en: "Latest" },
  dash_table_empty: { es: "No hay solicitudes recientes.", en: "No recent requests." },
  dash_flujos: { es: "Datos y Flujos Vivos", en: "Live Data & Flows" },
  dash_table_id: { es: "ID", en: "ID" },
  dash_table_solicitante: { es: "Solicitante", en: "Requester" },
  dash_table_sector: { es: "Sector", en: "Sector" },
  dash_table_estado: { es: "Estado", en: "Status" },
  dash_table_creada: { es: "Creada", en: "Created" },

  // Login
  login_title: { es: "Inicia sesión", en: "Sign in" },
  login_user_label: { es: "Mail o ID SPM", en: "Email or SPM ID" },
  login_pass_label: { es: "Contraseña", en: "Password" },
  login_submit: { es: "Ingresar", en: "Sign in" },
  login_loading: { es: "Ingresando...", en: "Signing in..." },
  login_recover: { es: "Recuperar Contraseña", en: "Recover password" },
  login_register: { es: "Registrarme", en: "Register" },
  login_recover_title: { es: "Recuperar Contraseña", en: "Recover password" },
  login_recover_desc: { es: "Ingresa el correo registrado. Enviaremos un enlace para generar una nueva contraseña.", en: "Enter the registered email. We will send a link to create a new password." },
  login_email_label: { es: "Correo electrónico", en: "Email" },
  login_cancel: { es: "Cancelar", en: "Cancel" },
  login_send_link: { es: "Enviar enlace", en: "Send link" },
  login_close: { es: "Cerrar", en: "Close" },
  login_register_fast: { es: "Registro rápido", en: "Quick registration" },
  login_name: { es: "Nombre", en: "Name" },
  login_register_submit: { es: "Registrarme", en: "Register" },
  login_feedback_sent: { es: "Solicitud de registro enviada. Completa tu perfil en el siguiente paso.", en: "Registration request sent. Complete your profile in the next step." },
  login_error_required: { es: "Usuario y contraseña son requeridos", en: "User and password are required" },
  login_error_default: { es: "Error en el login", en: "Login error" },
  login_recover_info: {
    es: "Si el correo {email} está registrado, enviaremos un enlace para restablecer la contraseña.",
    en: "If {email} is registered, we will send a link to reset the password.",
  },
  login_footer_dev: { es: "Desarrollado por Equipo SPM", en: "Built by SPM Team" },
  login_footer_follow: { es: "Siguenos", en: "Follow us" },
  login_footer_contact: { es: "Contacto", en: "Contact" },

  // Aprobaciones
  aprov_title: { es: "Aprobaciones", en: "Approvals" },
  aprov_subtitle: { es: "Solicitudes pendientes", en: "Pending requests" },
  aprov_search_placeholder: { es: "Buscar por ID, centro, sector o justificacion", en: "Search by ID, site, sector or justification" },
  aprov_loading: { es: "Cargando...", en: "Loading..." },
  aprov_no_items: { es: "No hay solicitudes pendientes", en: "No pending requests" },
  aprov_monto: { es: "Monto", en: "Amount" },
  aprov_estado: { es: "Estado", en: "Status" },
  aprov_acciones: { es: "Acciones", en: "Actions" },
  aprov_aprobar: { es: "Aprobar", en: "Approve" },
  aprov_rechazar: { es: "Rechazar", en: "Reject" },
  aprov_motivo: { es: "Motivo de rechazo", en: "Rejection reason" },
  aprov_aprobada_msg: { es: "Solicitud aprobada y asignada a planificador.", en: "Request approved and assigned to planner." },
  aprov_rechazada_msg: { es: "Solicitud rechazada.", en: "Request rejected." },
  aprov_justificacion: { es: "Justificacion", en: "Justification" },
  aprov_centro: { es: "Centro", en: "Site" },
  aprov_sector: { es: "Sector", en: "Sector" },
  aprov_usuario: { es: "Usuario", en: "User" },
  common_loading: { es: "Cargando...", en: "Loading..." },

  // Mis solicitudes
  mis_title: { es: "Mis Solicitudes", en: "My Requests" },
  mis_subtitle: { es: "Historial y estado de tus solicitudes", en: "History and status of your requests" },
  mis_btn_nueva: { es: "Nueva solicitud", en: "New request" },
  mis_tabla_empty: { es: "No hay solicitudes creadas.", en: "No requests created." },
  mis_estado: { es: "Estado", en: "Status" },
  mis_creada: { es: "Creada", en: "Created" },
  mis_total: { es: "Total", en: "Total" },
  mis_creadas: { es: "Solicitudes Creadas", en: "Created Requests" },
  mis_total_label: { es: "Total", en: "Total" },
  mis_search: { es: "Buscar por ID, asunto, descripción o estado", en: "Search by ID, subject, description or status" },
  mis_col_asunto: { es: "Asunto / Justificación", en: "Subject / Justification" },
  mis_col_centro: { es: "Centro", en: "Site" },
  mis_col_sector: { es: "Sector", en: "Sector" },
  mis_col_criticidad: { es: "Criticidad", en: "Criticality" },
  mis_col_monto: { es: "Monto", en: "Amount" },
  mis_col_fecha: { es: "Fecha", en: "Date" },
  mis_col_accion: { es: "Acción", en: "Action" },
  mis_btn_ver: { es: "Ver", en: "View" },
  mis_btn_editar: { es: "Editar", en: "Edit" },
  mis_btn_eliminar: { es: "Eliminar", en: "Delete" },
  mis_btn_export: { es: "Exportar XLS", en: "Export XLS" },
  mis_btn_abrir: { es: "Abrir", en: "Open" },
  mis_empty: { es: "No tienes solicitudes creadas", en: "No requests created" },
  mis_no_results: { es: "No hay resultados para los filtros aplicados", en: "No results for the applied filters" },
  mis_confirm_delete: { es: "¿Estás seguro de eliminar esta solicitud?", en: "Are you sure you want to delete this request?" },
  mis_delete_success: { es: "Solicitud eliminada correctamente", en: "Request deleted successfully" },
  mis_export_success: { es: "Datos exportados correctamente", en: "Data exported successfully" },
  mis_filter_all_estados: { es: "Todos los estados", en: "All statuses" },
  mis_filter_borrador: { es: "Borrador", en: "Draft" },
  mis_filter_enviada: { es: "Enviada", en: "Sent" },
  mis_filter_aprobada: { es: "Aprobada", en: "Approved" },
  mis_filter_rechazada: { es: "Rechazada", en: "Rejected" },
  mis_filter_planificacion: { es: "En Planificación", en: "In Planning" },
  mis_filter_despachada: { es: "Despachada", en: "Dispatched" },
  mis_filter_cerrada: { es: "Cerrada", en: "Closed" },
  mis_filter_all_centros: { es: "Todos los centros", en: "All sites" },
  mis_page: { es: "Página", en: "Page" },
  mis_of: { es: "de", en: "of" },
  mis_showing: { es: "Mostrando", en: "Showing" },
  mis_prev: { es: "Anterior", en: "Previous" },
  mis_next: { es: "Siguiente", en: "Next" },

  // MisSolicitudes - Stats cards
  mis_stats_total: { es: "Total", en: "Total" },
  mis_stats_borradores: { es: "Borradores", en: "Drafts" },
  mis_stats_enviadas: { es: "Enviadas", en: "Submitted" },
  mis_stats_aprobadas: { es: "Aprobadas", en: "Approved" },
  mis_stats_rechazadas: { es: "Rechazadas", en: "Rejected" },

  // MisSolicitudes - Tabs
  mis_tab_todas: { es: "Todas", en: "All" },
  mis_tab_borradores: { es: "Borradores", en: "Drafts" },
  mis_tab_enviadas: { es: "Enviadas", en: "Submitted" },
  mis_tab_aprobadas: { es: "Aprobadas", en: "Approved" },
  mis_tab_rechazadas: { es: "Rechazadas", en: "Rejected" },

  // MisSolicitudes - Page
  mis_page_title: { es: "MIS SOLICITUDES", en: "MY REQUESTS" },
  nav_dashboard: { es: "Dashboard", en: "Dashboard" },

  // Planner
  planner_title: { es: "Planificador", en: "Planner" },
  planner_subtitle: { es: "Solicitudes asignadas", en: "Assigned requests" },
  planner_filters: { es: "Filtros", en: "Filters" },
  planner_search: { es: "Buscar por ID o justificacion", en: "Search by ID or justification" },
  planner_empty: { es: "No hay solicitudes asignadas.", en: "No assigned requests." },
  planner_acciones: { es: "Acciones", en: "Actions" },
  planner_ver: { es: "Ver detalles y tratar solicitud", en: "View details and process request" },
  planner_aceptar: { es: "Aceptar", en: "Accept" },
  planner_finalizar: { es: "Finalizar", en: "Finish" },
  planner_gestion: { es: "Gestion de solicitudes aprobadas", en: "Approved requests management" },
  planner_usuario: { es: "Usuario", en: "User" },
  planner_centro: { es: "Centro", en: "Site" },
  planner_sector: { es: "Sector", en: "Sector" },
  planner_placeholder_centro: { es: "Ej: 1008", en: "Ex: 1008" },
  planner_placeholder_sector: { es: "Ej: Mantenimiento", en: "Ex: Maintenance" },
  planner_actualizar: { es: "Actualizar", en: "Refresh" },
  planner_actualizando: { es: "Actualizando...", en: "Refreshing..." },
  planner_justificacion: { es: "Justificacion", en: "Justification" },
  planner_monto: { es: "Monto", en: "Amount" },
  planner_estado: { es: "Estado", en: "Status" },
  planner_tratar: { es: "Tratar", en: "Treat" },
  planner_aceptar_progreso: { es: "Aceptar / En progreso", en: "Accept / In progress" },
  planner_marcar_tratado: { es: "Marcar tratado", en: "Mark treated" },
  planner_empty_full: { es: "Sin solicitudes asignadas/aprobadas", en: "No assigned/approved requests" },
  planner_msg_aceptar: { es: "Solicitud aceptada y marcada en progreso.", en: "Request accepted and set in progress." },
  planner_msg_finalizar: { es: "Solicitud tratada/finalizada.", en: "Request processed/finished." },
  planner_rechazar: { es: "Rechazar", en: "Reject" },
  planner_rechazar_motivo: { es: "Motivo del rechazo", en: "Rejection reason" },
  planner_rechazar_placeholder: { es: "Explica brevemente el motivo del rechazo...", en: "Briefly explain the reason for rejection..." },
  planner_rechazar_guardar: { es: "Confirmar rechazo", en: "Confirm rejection" },
  planner_rechazar_cancelar: { es: "Cancelar", en: "Cancel" },
  planner_rechazar_success: { es: "Solicitud rechazada correctamente.", en: "Request rejected successfully." },
  planner_criticidad: { es: "Criticidad", en: "Criticality" },
  planner_fecha: { es: "Fecha necesidad", en: "Need date" },
  planner_busqueda_general: { es: "Búsqueda general", en: "General search" },
  planner_buscar_placeholder: { es: "Buscar por ID, asunto, solicitante...", en: "Search by ID, subject, requester..." },
  planner_todos_centros: { es: "Todos los centros", en: "All sites" },
  planner_todos_sectores: { es: "Todos los sectores", en: "All sectors" },
  planner_sector_almacenes: { es: "Almacenes", en: "Warehouses" },
  planner_sector_compras: { es: "Compras", en: "Purchasing" },
  planner_sector_mantenimiento: { es: "Mantenimiento", en: "Maintenance" },
  planner_sector_planificacion: { es: "Planificación", en: "Planning" },
  planner_sector_operaciones: { es: "Operaciones", en: "Operations" },
  planner_sector_logistica: { es: "Logística", en: "Logistics" },
  planner_sector_produccion: { es: "Producción", en: "Production" },
  planner_sector_calidad: { es: "Calidad", en: "Quality" },
  planner_todos_estados: { es: "Todos los estados", en: "All statuses" },
  planner_estado_aprobada: { es: "Aprobada", en: "Approved" },
  planner_estado_progreso: { es: "En Progreso", en: "In Progress" },
  planner_estado_finalizada: { es: "Finalizada", en: "Finished" },
  planner_estado_rechazada: { es: "Rechazada", en: "Rejected" },
  planner_criticidad_todas: { es: "Todas", en: "All" },
  planner_criticidad_normal: { es: "Normal", en: "Normal" },
  planner_criticidad_alta: { es: "Alta", en: "High" },
  planner_solicitudes_asignadas: { es: "Solicitudes Asignadas", en: "Assigned Requests" },
  planner_solicitud: { es: "solicitud", en: "request" },
  planner_solicitudes: { es: "solicitudes", en: "requests" },
  planner_exportar_xls: { es: "Exportar XLS", en: "Export XLS" },
  planner_export_success: { es: "Datos exportados correctamente", en: "Data exported successfully" },
  planner_rechazar_solicitud: { es: "Rechazar Solicitud", en: "Reject Request" },
  planner_rechazar_motivo_label: { es: "Motivo del rechazo", en: "Rejection reason" },
  planner_confirmar_rechazo: { es: "Confirmar Rechazo", en: "Confirm Rejection" },
  planner_rechazar_motivo_required: { es: "Debes indicar el motivo del rechazo", en: "You must provide a reason for rejection" },
  planner_fecha_creacion: { es: "F. Creación", en: "Created" },

  // Create solicitud
  crear_title: { es: "Nueva Solicitud", en: "New Request" },
  crear_subtitle: { es: "Completa la informacion basica", en: "Fill in the basic information" },
  crear_guardar: { es: "Guardar borrador", en: "Save draft" },
  crear_enviar: { es: "Enviar para aprobacion", en: "Send for approval" },
  crear_items_title: { es: "Items", en: "Items" },
  crear_add_item: { es: "Agregar item", en: "Add item" },
  crear_remove_item: { es: "Eliminar", en: "Remove" },
  crear_total: { es: "Total estimado", en: "Estimated total" },
  crear_success: { es: "Solicitud creada", en: "Request created" },

  // Materials
  materials_title: { es: "Agregar Materiales", en: "Add Materials" },
  materials_search: { es: "Buscar materiales", en: "Search materials" },
  materials_empty: { es: "No hay materiales", en: "No materials" },
  materials_limpiar_busqueda: { es: "Limpiar búsqueda", en: "Clear search" },
  materials_cancelar_solicitud: { es: "Cancelar Solicitud", en: "Cancel Request" },
  materials_cancelar_confirm: { es: "Se borrarán todos los datos ingresados. ¿Continuar?", en: "All entered data will be deleted. Continue?" },
  materials_error_catalogos: { es: "Error al cargar catálogos. Intenta recargar la página.", en: "Error loading catalogs. Try reloading the page." },
  materials_buscar: { es: "Buscar material", en: "Search material" },
  materials_buscar_desc: { es: "Buscar por descripción...", en: "Search by description..." },
  materials_selecciona_uno: { es: "selecciona uno", en: "select one" },
  materials_selected: { es: "Material seleccionado", en: "Selected material" },
  materials_precio: { es: "Precio", en: "Price" },
  materials_busca_selecciona: { es: "Busca y selecciona un material", en: "Search and select a material" },
  materials_contexto: { es: "Contexto", en: "Context" },
  materials_saldo_disponible: { es: "Saldo disponible", en: "Available balance" },

  // Mi cuenta
  micuenta_title: { es: "Mi cuenta", en: "My account" },
  micuenta_perfil: { es: "Perfil", en: "Profile" },
  micuenta_actualizar: { es: "Actualizar", en: "Update" },

  // Admin comunes
  admin_title: { es: "Administración", en: "Admin" },
  admin_guardar: { es: "Guardar", en: "Save" },
  admin_crear: { es: "Crear", en: "Create" },
  admin_editar: { es: "Editar", en: "Edit" },
  admin_eliminar: { es: "Eliminar", en: "Delete" },
  admin_cancelar: { es: "Cancelar", en: "Cancel" },
  admin_nombre: { es: "Nombre", en: "Name" },
  admin_codigo: { es: "Código", en: "Code" },
  admin_id: { es: "ID", en: "ID" },
  admin_descripcion: { es: "Descripción", en: "Description" },
  admin_notas: { es: "Notas", en: "Notes" },
  admin_estado_label: { es: "Estado", en: "Status" },
  admin_activo: { es: "Activo", en: "Active" },
  admin_centro_codigo: { es: "Centro Código", en: "Site Code" },
  admin_inactivo: { es: "Inactivo", en: "Inactive" },
  admin_disponible: { es: "Disponible", en: "Available" },
  admin_required_fields: { es: "Faltan campos obligatorios", en: "Required fields missing" },
  admin_created_success: { es: "Creado exitosamente", en: "Created successfully" },
  admin_updated_success: { es: "Actualizado exitosamente", en: "Updated successfully" },
  admin_deleted_success: { es: "Eliminado exitosamente", en: "Deleted successfully" },
  admin_confirm_delete: { es: "¿Estás seguro de eliminar este elemento?", en: "Are you sure you want to delete this item?" },
  admin_loading: { es: "Cargando...", en: "Loading..." },
  admin_search_placeholder: { es: "Buscar...", en: "Search..." },
  admin_no_results: { es: "No se encontraron resultados", en: "No results found" },
  admin_showing: { es: "Mostrando", en: "Showing" },
  admin_of: { es: "de", en: "of" },
  admin_page: { es: "Página", en: "Page" },
  admin_prev: { es: "Anterior", en: "Previous" },
  admin_next: { es: "Siguiente", en: "Next" },
  admin_add_new: { es: "Agregar Nuevo", en: "Add New" },
  admin_edit_item: { es: "Editar Elemento", en: "Edit Item" },
  admin_new_item: { es: "Nuevo Elemento", en: "New Item" },
  admin_si: { es: "Sí", en: "Yes" },
  admin_no: { es: "No", en: "No" },

  // CRUD Template
  crud_manage_catalog: { es: "Gestiona el catálogo de", en: "Manage the catalog of" },
  crud_total_records: { es: "Total de registros:", en: "Total records:" },
  crud_search: { es: "Buscar", en: "Search" },
  crud_no_results_search: { es: "No hay resultados para la búsqueda", en: "No results found for the search" },
  crud_no_items_created: { es: "creados", en: "created" },
  crud_no_hay: { es: "No hay", en: "No" },
  crud_new: { es: "Nuevo", en: "New" },
  crud_edit: { es: "Editar", en: "Edit" },
  crud_saving: { es: "Guardando...", en: "Saving..." },
  crud_create: { es: "Crear", en: "Create" },
  crud_update: { es: "Actualizar", en: "Update" },
  crud_complete_required: { es: "Completa los campos obligatorios", en: "Complete the required fields" },
  crud_select: { es: "Selecciona", en: "Select" },
  crud_record_created: { es: "Registro creado correctamente", en: "Record created successfully" },
  crud_record_updated: { es: "Registro actualizado correctamente", en: "Record updated successfully" },
  crud_record_deleted: { es: "Registro eliminado correctamente", en: "Record deleted successfully" },
  crud_confirm_delete_record: { es: "¿Estás seguro de eliminar este registro?", en: "Are you sure you want to delete this record?" },

  // Estados de solicitud
  status_borrador: { es: "Borrador", en: "Draft" },
  status_enviada: { es: "Enviada", en: "Sent" },
  status_pendiente: { es: "Pendiente de Aprobación", en: "Pending Approval" },
  status_aprobada: { es: "Aprobada", en: "Approved" },
  status_rechazada: { es: "Rechazada", en: "Rejected" },
  status_en_planificacion: { es: "En Planificación", en: "In Planning" },
  status_planificacion: { es: "Planificación", en: "Planning" },
  status_progreso: { es: "En Progreso", en: "In Progress" },
  status_proceso: { es: "En Proceso", en: "In Process" },
  status_despachada: { es: "Despachada", en: "Dispatched" },
  status_cerrada: { es: "Cerrada", en: "Closed" },
  status_finalizada: { es: "Finalizada", en: "Finished" },
  status_completada: { es: "Completada", en: "Completed" },
  status_tratada: { es: "Tratada", en: "Treated" },
  status_presupuesto_insuficiente: { es: "Presupuesto Insuficiente", en: "Insufficient Budget" },

  // Criticidad
  criticidad_normal: { es: "Normal", en: "Normal" },
  criticidad_alta: { es: "Alta", en: "High" },
  criticidad_label: { es: "Criticidad", en: "Criticality" },

  // Comunes
  common_codigo: { es: "Código", en: "Code" },
  common_descripcion: { es: "Descripción", en: "Description" },
  common_cantidad: { es: "Cantidad", en: "Quantity" },
  common_precio: { es: "Precio", en: "Price" },
  common_total: { es: "Total", en: "Total" },
  common_buscar: { es: "Buscar", en: "Search" },
  common_filtrar: { es: "Filtrar", en: "Filter" },
  common_exportar: { es: "Exportar", en: "Export" },
  common_cancelar: { es: "Cancelar", en: "Cancel" },
  common_confirmar: { es: "Confirmar", en: "Confirm" },
  common_si: { es: "Sí", en: "Yes" },
  common_no: { es: "No", en: "No" },
  common_aceptar: { es: "Aceptar", en: "Accept" },
  common_rechazar: { es: "Rechazar", en: "Reject" },
  common_guardar: { es: "Guardar", en: "Save" },
  common_editar: { es: "Editar", en: "Edit" },
  common_eliminar: { es: "Eliminar", en: "Delete" },
  common_ver: { es: "Ver", en: "View" },
  common_acciones: { es: "Acciones", en: "Actions" },
  common_fecha: { es: "Fecha", en: "Date" },
  common_estado: { es: "Estado", en: "Status" },
  common_usuario: { es: "Usuario", en: "User" },
  common_centro: { es: "Centro", en: "Site" },
  common_sector: { es: "Sector", en: "Sector" },
  common_almacen: { es: "Almacén", en: "Warehouse" },
  common_materiales: { es: "Materiales", en: "Materials" },
  common_presupuesto: { es: "Presupuesto", en: "Budget" },
  common_monto: { es: "Monto", en: "Amount" },
  common_justificacion: { es: "Justificación", en: "Justification" },
  common_comentario: { es: "Comentario", en: "Comment" },
  common_cargando: { es: "Cargando...", en: "Loading..." },
  common_error: { es: "Error", en: "Error" },
  common_exito: { es: "Éxito", en: "Success" },
  common_advertencia: { es: "Advertencia", en: "Warning" },
  common_informacion: { es: "Información", en: "Information" },
  common_del_sistema: { es: "del sistema", en: "of the system" },
  common_pagina: { es: "Página", en: "Page" },
  common_de: { es: "de", en: "of" },
  common_mostrando: { es: "Mostrando", en: "Showing" },
  common_anterior: { es: "Anterior", en: "Previous" },
  common_siguiente: { es: "Siguiente", en: "Next" },
  common_volver: { es: "Volver", en: "Back" },
  common_volver_mis_solicitudes: { es: "Volver a Mis Solicitudes", en: "Back to My Requests" },
  common_sin_guardar: { es: "Sin guardar", en: "Unsaved" },
  common_solicitud: { es: "Solicitud", en: "Request" },
  common_resultado: { es: "resultado", en: "result" },
  common_resultados: { es: "resultados", en: "results" },
  common_buscando: { es: "Buscando...", en: "Searching..." },
  common_cerrar: { es: "Cerrar", en: "Close" },
  common_item: { es: "item", en: "item" },
  common_items: { es: "items", en: "items" },
  common_optional: { es: "(opcional)", en: "(optional)" },

  // Crear Solicitud - Archivos
  create_adjuntos: { es: "Archivos Adjuntos", en: "Attachments" },
  create_adjuntos_placeholder: { es: "Arrastra archivos aquí o haz clic para seleccionar", en: "Drag files here or click to select" },
  create_adjuntos_max: { es: "Máximo {max} archivos", en: "Maximum {max} files" },
  upload_remove: { es: "Eliminar", en: "Remove" },
  upload_size_error: { es: "El archivo excede el tamaño máximo permitido", en: "File exceeds maximum allowed size" },

  // Ayuda
  nav_ayuda: { es: "Ayuda", en: "Help" },
  ayuda_title: { es: "Ayuda", en: "Help" },
  ayuda_contactar: { es: "Contactar Administrador", en: "Contact Administrator" },
  ayuda_instrucciones: { es: "Instrucciones de Uso", en: "Usage Instructions" },
  ayuda_urgente: { es: "Ayuda Urgente", en: "Urgent Help" },

  // Budget Update Requests (BUR)
  nav_budget_requests: { es: "Solicitudes de Presupuesto", en: "Budget Requests" },
  bur_title: { es: "Solicitudes de Presupuesto", en: "Budget Requests" },
  bur_subtitle: { es: "Gestiona solicitudes de aumento de presupuesto", en: "Manage budget increase requests" },
  bur_crear: { es: "Incorporar Saldo", en: "Add Funds" },
  bur_empty: { es: "No hay solicitudes de presupuesto", en: "No budget requests" },
  bur_loading: { es: "Cargando solicitudes...", en: "Loading requests..." },
  bur_search_placeholder: { es: "Buscar por centro, sector o justificacion", en: "Search by site, sector or justification" },
  bur_col_id: { es: "ID", en: "ID" },
  bur_col_centro: { es: "Centro", en: "Site" },
  bur_col_sector: { es: "Sector", en: "Sector" },
  bur_col_monto: { es: "Monto Solicitado", en: "Requested Amount" },
  bur_col_estado: { es: "Estado", en: "Status" },
  bur_col_nivel: { es: "Nivel Aprobacion", en: "Approval Level" },
  bur_col_fecha: { es: "Fecha", en: "Date" },
  bur_col_acciones: { es: "Acciones", en: "Actions" },
  bur_ver: { es: "Ver", en: "View" },
  bur_aprobar: { es: "Aprobar", en: "Approve" },
  bur_rechazar: { es: "Rechazar", en: "Reject" },
  bur_aprobada_msg: { es: "Solicitud de presupuesto aprobada", en: "Budget request approved" },
  bur_rechazada_msg: { es: "Solicitud de presupuesto rechazada", en: "Budget request rejected" },
  bur_create_title: { es: "Nueva Solicitud de Presupuesto", en: "New Budget Request" },
  bur_create_subtitle: { es: "Solicita un aumento de presupuesto para un centro/sector", en: "Request a budget increase for a site/sector" },
  bur_campo_centro: { es: "Centro", en: "Site" },
  bur_campo_sector: { es: "Sector", en: "Sector" },
  bur_campo_monto: { es: "Monto (USD)", en: "Amount (USD)" },
  bur_campo_justificacion: { es: "Justificacion", en: "Justification" },
  bur_campo_justificacion_placeholder: { es: "Explica el motivo del aumento de presupuesto...", en: "Explain the reason for the budget increase..." },
  bur_btn_enviar: { es: "Enviar Solicitud", en: "Submit Request" },
  bur_btn_cancelar: { es: "Cancelar", en: "Cancel" },
  bur_create_success: { es: "Solicitud creada exitosamente", en: "Request created successfully" },
  bur_create_error: { es: "Error al crear solicitud", en: "Error creating request" },
  bur_detail_title: { es: "Detalle de Solicitud", en: "Request Detail" },
  bur_estado_pendiente: { es: "Pendiente", en: "Pending" },
  bur_estado_aprobado_l1: { es: "Aprobado L1", en: "Approved L1" },
  bur_estado_aprobado_l2: { es: "Aprobado L2", en: "Approved L2" },
  bur_estado_aprobado: { es: "Aprobado", en: "Approved" },
  bur_estado_rechazado: { es: "Rechazado", en: "Rejected" },
  bur_nivel_l1: { es: "Nivel 1 (hasta $200K)", en: "Level 1 (up to $200K)" },
  bur_nivel_l2: { es: "Nivel 2 (hasta $1M)", en: "Level 2 (up to $1M)" },
  bur_nivel_admin: { es: "Admin (mas de $1M)", en: "Admin (over $1M)" },
  bur_motivo_rechazo: { es: "Motivo de rechazo", en: "Rejection reason" },
  bur_motivo_placeholder: { es: "Indica el motivo del rechazo...", en: "Enter the reason for rejection..." },
  bur_comentario_aprobacion: { es: "Comentario (opcional)", en: "Comment (optional)" },
  bur_solicitante: { es: "Solicitante", en: "Requester" },
  bur_fecha_creacion: { es: "Fecha de creacion", en: "Creation date" },
  bur_saldo_actual: { es: "Saldo actual", en: "Current balance" },
  bur_saldo_nuevo: { es: "Nuevo saldo (estimado)", en: "New balance (estimated)" },
  bur_pendientes: { es: "Pendientes de Aprobar", en: "Pending Approval" },
  bur_pendientes_subtitle: { es: "Solicitudes que puedes aprobar o rechazar", en: "Requests you can approve or reject" },
  bur_tab_todas: { es: "Todas", en: "All" },
  bur_tab_pendientes: { es: "Pendientes", en: "Pending" },
  bur_tab_aprobadas: { es: "Aprobadas", en: "Approved" },
  bur_tab_rechazadas: { es: "Rechazadas", en: "Rejected" },
  bur_permiso_denegado: { es: "No tienes permiso para realizar esta accion", en: "You don't have permission to perform this action" },
};

export function I18nProvider({ children }) {
  const [lang, setLangState] = useState("es");

  useEffect(() => {
    const stored = localStorage.getItem("lang");
    if (stored) {
      setLangState(stored);
      document.documentElement.setAttribute("data-lang", stored);
    } else {
      document.documentElement.setAttribute("data-lang", "es");
    }
  }, []);

  useEffect(() => {
    document.documentElement.setAttribute("data-lang", lang);
    localStorage.setItem("lang", lang);
  }, [lang]);

  const setLang = (value) => {
    setLangState(value);
  };

  const value = useMemo(
    () => ({
      lang,
      setLang,
      t: (key, fallback) => {
        const entry = translations[key];
        if (!entry) return fallback || key;
        return entry[lang] || fallback || entry.es || key;
      },
    }),
    [lang]
  );

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n() {
  return useContext(I18nContext);
}

export { translations };
